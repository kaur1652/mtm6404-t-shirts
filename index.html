<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T-Shirts</title>

  <!-- React CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel CDN -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body>

  <div id="root"></div>

  <!-- t-shirts Data File -->
  <script src="t-shirts.js"></script>

  <!-- React Code -->
  <script type="text/babel">

    function App() {

      const [shirts, setShirts] = React.useState(tshirts)

      return (
        <div>
          <h1>T-Shirt Store</h1>

          {shirts.map(function (shirt, index) {
            return (
              <div key={shirt.title}>
                <h2>{shirt.title}</h2>

                <img
                  src={"images/" + shirt.image}
                  alt={shirt.title}
                  width="200"
                />

                <p>Price: ${shirt.price}</p>

                <p>Stock Remaining: {shirt.stock}</p>

                {shirt.stock === 0 ? (
                  <p><strong>Out of Stock</strong></p>
                ) : (
                  <div>

                    <select
                      value={shirt.quantity|| 1}
                      onChange={function (e) {
                        const updated = shirts.map(function (item) {
                          if (item.title === shirt.title) {
                            return {
                              ...item,
                              quantity: parseInt(e.target.value)
                            }
                          }
                          return item
                        })
                        setShirts(updated)
                      }}
                    >
                      {Array.from({ length: shirt.stock }, function (_, index) {
                        return (
                          <option key={index} value={index + 1}>
                            {index + 1}
                          </option>
                        )
                      })}
                    </select>

                    <button
                      onClick={function () {
                        const updated = shirts.map(function (item) {
                          if (item.title === shirt.title) {
                            return {
                              ...item,
                              stock: item.stock - (item.quantity || 1 )
                            }
                          }
                          return item
                        })
                        setShirts(updated)
                      }}
                    >
                      Buy
                    </button>

                  </div>
                )}

                <hr />
              </div>
            )
          })}

        </div>
      )
    }

    const root = ReactDOM.createRoot(
      document.getElementById('root')
    )

    root.render(<App />)

  </script>

</body>

</html>